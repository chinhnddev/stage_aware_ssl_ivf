data:
  csv_paths:
    - data-curation/metadata_public.csv
    - data-curation/metadata_hospital_all.csv
  root_map:
    public: "/content/data/embyro_public_dataset"
    hospital: "/content/data/HungVuong_hospital_dataset/Human embryo image datasets"
  img_size: 224
  batch_size: 128
  num_workers: 8
  use_domains: ["public", "hospital"]
  stage_keys: ["day", "stage_group"]

ssl:
  method: byol
  backbone: resnet50
  proj_dim: 256
  pred_dim: 256
  ema_tau: 0.996
  lr: 0.001
  weight_decay: 1.0e-6
  epochs: 200
  warmup_epochs: 10
  optimizer: adamw
  scheduler: cosine
  fp16: true
  seed: 42

stage:
  enabled: true
  num_stage_positives: 1   # use a single positive per anchor to reduce noise
  lambda_stage: 0.2        # softer weighting for stage consistency
  min_per_stage_in_batch: 2

logging:
  out_dir: outputs/ssl_byol_stage
  log_every: 50
  save_every_epochs: 10
  early_stop_patience: 20
