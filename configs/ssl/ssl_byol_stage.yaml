data:
  csv_paths:
    - data-curation/metadata_ssl.csv
  root_map:
    roboflow_ssl: "/content/data/embyro_public_dataset"
    hv_clinical: "/content/data/HungVuong_hospital_dataset/Human embryo image datasets"  # optional target_unlabeled
  img_size: 224
  batch_size: 128
  num_workers: 12
  use_domains: ["roboflow_ssl"]
  use_roles: ["ssl"]
  stage_keys: ["stage_raw", "stage_group"]

ssl:
  method: byol
  backbone: resnet50
  proj_dim: 256
  pred_dim: 256
  ema_tau: 0.996
  lr: 0.0005
  weight_decay: 1.0e-6
  epochs: 100
  warmup_epochs: 20
  optimizer: adamw
  scheduler: cosine
  fp16: true
  seed: 42

stage:
  enabled: true
  num_stage_positives: 2
  lambda_stage: 0.08
  min_per_stage_in_batch: 3

logging:
  out_dir: outputs/ssl_byol_stage
  log_every: 50
  save_every_epochs: 10
